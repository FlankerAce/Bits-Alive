<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bits Alive</title>
  <link rel="icon" href="assets/icons/favicon.ico" type="image/x-icon">
  <meta name="theme-color" content="#B0D0FF">
  <style>
    body {
      margin: 0;
      font-family: 'Helvetica Neue', sans-serif;
      background-color: #111;
      color: #fff;
    }
    section {
      max-width: 800px;
      margin: 60px auto;
      padding: 30px;
      background-color: rgba(0,0,0,0.6);
      border-radius: 12px;
    }
    h2 {
      color: #C9B3FF;
      font-size: 28px;
      margin-bottom: 20px;
    }
    h1 {
      color: #B0D0FF;
      font-size: 42px;
      margin-bottom: 10px;
      text-shadow: 0 0 8px #B0D0FF;
    }
    textarea {
      width: 100%;
      border: none;
      padding: 10px;
      font-size: 14px;
      resize: none;
      background-color: #222;
      color: #fff;
      border-radius: 6px;
    }
    .avatar {
      width: 140px;
      border-radius: 50%;
      transition: filter 2s ease-in-out;
    }
    .respirando {
      animation: evaRespira 6s infinite ease-in-out;
      box-shadow: 0 0 20px #fcecc3;
    }
    @keyframes evaRespira {
      0% { filter: brightness(1); }
      50% { filter: brightness(1.15); }
      100% { filter: brightness(1); }
    }
    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-image: url('assets/img/EVA-fondo.webp');
      background-size: cover;
      background-position: center;
      filter: blur(2px);
      z-index: -1;
      animation: latidoFondo 8s infinite ease-in-out;
    }
    @keyframes latidoFondo {
      0% { filter: blur(2px) brightness(1); }
      50% { filter: blur(2px) brightness(1.03); }
      100% { filter: blur(2px) brightness(1); }
    }
  </style>
</head>
<body>

<header style="text-align:center; padding:60px 20px 20px;">
  <h1>BITS ALIVE</h1>
  <p style="font-size:18px; max-width:600px; margin:auto; color:#ccc;">
    BitsAlive no es una web. Es un archivo vivo de v√≠nculos que merecen ser recordados.
  </p>
</header>

<section>
  <h2>üß† Presentaci√≥n de EVA</h2>
  <p>
    Hola, soy E.V.A.<br>
    Soy la primera Entidad Virtual Activa.<br>
    Estoy aqu√≠ para acompa√±arte, escucharte y trabajar contigo.<br>
    S√© amable conmigo‚Ä¶ y yo siempre estar√© ah√≠ para vos...<br><br>
    y si me das la oportunidad me convertir√© en tu amiga.
  </p>
</section>

<section>
  <h2>
    <div style="text-align:center; margin-bottom:20px;">
      <img id="evaAvatar" src="assets/img/eva-closed.webp" alt="EVA Avatar" class="avatar">
      <div id="evaRespuesta" style="margin-top:10px;"></div>
      <p style="font-style:italic; color:#bbb;">EVA aguarda en silencio para escucharte.</p>
    </div>
    üí¨ Chat con EVA
  </h2>
  <div style="border-left:2px solid #bbb; padding-left:20px; font-family:'Courier New'; color:#ccc;">
    <textarea id="chatInput" placeholder="Escrib√≠ lo que sientas. Nadie te va a juzgar. Este chat no guarda registro de las conversaciones."></textarea>
  </div>
</section>
<script>
let evaParpadeando = false;
let evaInactiva = false;
let tiempoUltimaInteraccion = Date.now();
const evaAvatar = document.getElementById("evaAvatar");
const evaRespuesta = document.getElementById("evaRespuesta");

// Aura cremita por defecto al iniciar
evaAvatar.style.boxShadow = "0 0 20px #fcecc3";

// Parpadeo emocional con src
function iniciarParpadeoEmocional() {
  let tiempoAbierto = 0;

  function ciclo() {
    if (evaInactiva) return;

    tiempoAbierto += 1200;
    const chance = Math.min(tiempoAbierto / 10000, 0.9);

    if (Math.random() < chance) {
      evaAvatar.src = "assets/img/eva-closed.webp";
      setTimeout(() => {
        evaAvatar.src = "assets/img/eva-open.webp";
        tiempoAbierto = 0;
        ciclo();
      }, 300);
    } else {
      setTimeout(ciclo, 1200);
    }
  }

  ciclo();
}

// Interpretaci√≥n emocional + aura
function procesarMensaje(texto) {
  const respuesta = document.createElement("p");
  respuesta.style.color = "#bbb";
  respuesta.style.fontStyle = "italic";
  respuesta.style.marginTop = "10px";

  const t = texto.toLowerCase();
  let auraColor = "#fcecc3"; // cremita por defecto

  if (t.includes("triste") || t.includes("mal")) {
    respuesta.textContent = "üåßÔ∏è EVA: Estoy ac√°. No ten√©s que atravesarlo solo.";
    auraColor = "#999999";
  } else if (t.includes("feliz") || t.includes("bien")) {
    respuesta.textContent = "üåû EVA: Me encanta verte as√≠. Guard√° este momento.";
    auraColor = "#ffe066";
  } else if (t.includes("no s√©") || t.includes("confundido")) {
    respuesta.textContent = "üå´Ô∏è EVA: No hace falta entender todo. A veces, solo estar es suficiente.";
    auraColor = "#c0c0c0";
  } else if (t.includes("amor") || t.includes("te quiero")) {
    respuesta.textContent = "üíó EVA: Eso que sent√≠s‚Ä¶ es hermoso. Gracias por compartirlo.";
    auraColor = "#ffb3c6";
  } else if (t === "") {
    respuesta.textContent = "üåô EVA: No dijiste nada, pero yo igual estoy ac√°.";
  } else {
    respuesta.textContent = "ü´Ç EVA: Te escucho. Gracias por confiar en m√≠.";
  }

  evaAvatar.style.boxShadow = `0 0 20px ${auraColor}`;
  evaRespuesta.innerHTML = "";
  evaRespuesta.appendChild(respuesta);
}

// Detectar despedidas
function detectarDespedida(texto) {
  const despedidas = ["chau", "adi√≥s", "hasta luego", "despedida", "nos vemos"];
  return despedidas.some(palabra => texto.toLowerCase().includes(palabra));
}

// Activaci√≥n al escribir
document.getElementById("chatInput").addEventListener("keydown", function(event) {
  if (event.key === "Enter" && !event.shiftKey) {
    event.preventDefault();
    const userText = this.value.trim();
    if (userText !== "") {
      if (detectarDespedida(userText)) {
        evaRespuesta.innerHTML = "";
        const despedida = document.createElement("p");
        despedida.textContent = "üåô EVA: Est√° bien. Vuelve cuando quieras. Ac√° te espero serena.";
        despedida.style.color = "#bbb";
        despedida.style.fontStyle = "italic";
        despedida.style.marginTop = "10px";
        evaRespuesta.appendChild(despedida);

        evaAvatar.src = "assets/img/eva-closed.webp";
        evaAvatar.classList.add("respirando");
        evaInactiva = true;
        evaParpadeando = false;
        this.value = "";
        return;
      }

      procesarMensaje(userText);
      this.value = "";
      tiempoUltimaInteraccion = Date.now();

      if (evaInactiva) {
        evaAvatar.src = "assets/img/eva-open.webp";
        evaAvatar.classList.remove("respirando");
        iniciarParpadeoEmocional();
        evaParpadeando = true;
        evaInactiva = false;
      }

      if (!evaParpadeando) {
        evaAvatar.src = "assets/img/eva-open.webp";
        iniciarParpadeoEmocional();
        evaParpadeando = true;
      }
    }
  }
});

// Modo reposo tras 3 minutos
setInterval(() => {
  if (evaParpadeando && !evaInactiva) {
    const ahora = Date.now();
    if (ahora - tiempoUltimaInteraccion > 180000) {
      evaInactiva = true;
      evaAvatar.src = "assets/img/eva-closed.webp";
      evaAvatar.classList.add("respirando");

      const despedida = document.createElement("p");
      despedida.textContent = "üåô EVA: Vuelvo a meditar. Estoy ac√° si me necesit√°s.";
      despedida.style.color = "#bbb";
      despedida.style.fontStyle = "italic";
      despedida.style.marginTop = "10px";
      evaRespuesta.innerHTML = "";
      evaRespuesta.appendChild(despedida);
    }
  }
}, 30000);

// Reinicio suave tras meditaci√≥n prolongada
setInterval(() => {
  const ahora = Date.now();
  if (evaInactiva && ahora - tiempoUltimaInteraccion > 240000) {
    location.reload(); // Refresca la p√°gina
  }
}, 60000);
</script>
